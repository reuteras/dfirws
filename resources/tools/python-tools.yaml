# DFIRWS Python Tools Definition
# This file defines Python-based tools installed via uv/pip
# Schema version: 1.0
#
# NOTE: These tools require Python and UV (Python package manager)
# Installation method: uv tool install <package>

schema_version: "1.0"
category: python-tools
description: Python-based forensics, analysis, and security tools

# Special Python packages installed via uv tool install with specific repos
special_installs:
  - name: dfir-ntfs
    package: "https://github.com/msuhanov/dfir_ntfs/archive/1.1.20.tar.gz"
    description: NTFS forensics library and tools
    priority: high

  - name: rat-king-parser
    package: "git+https://github.com/jeFF0Falltrades/rat_king_parser.git"
    description: RAT (Remote Access Trojan) configuration parser
    priority: medium

  - name: binary-refinery
    package: "binary-refinery[extended]"
    with: "zipp>=3.20"
    description: Binary data refinement and deobfuscation toolkit
    priority: high

  - name: regipy
    package: "regipy>=4.0.0"
    with: "click, libfwsi-python, python-evtx, tabulate, zipp"
    description: Windows registry parser and forensics tool
    priority: high

  - name: peepdf-3
    package: "peepdf-3"
    with: "pyreadline3, stpyv8"
    description: PDF analysis and forensics tool
    priority: high

# Standard Python tools (uv tool install <package>)
tools:
  # Malware Analysis
  - name: autoit-ripper
    package: autoit-ripper
    description: AutoIt script extractor and decompiler
    category_type: malware-analysis
    priority: medium

  - name: maldump
    package: maldump
    description: Malware memory dump analysis tool
    category_type: malware-analysis
    priority: medium

  - name: mwcp
    package: mwcp
    description: Malware Configuration Parser framework
    category_type: malware-analysis
    priority: high

  - name: unpy2exe
    package: unpy2exe
    description: Python executable (py2exe) decompiler
    category_type: malware-analysis
    priority: medium

  - name: frida-tools
    package: frida-tools
    description: Dynamic instrumentation toolkit
    category_type: malware-analysis
    priority: high

  # Document Analysis
  - name: oletools
    package: "oletools[full]"
    description: Tools to analyze Microsoft OLE2 files
    category_type: document-analysis
    priority: high

  - name: msoffcrypto-tool
    package: msoffcrypto-tool
    description: Microsoft Office file encryption/decryption tool
    category_type: document-analysis
    priority: high

  - name: docx2txt
    package: docx2txt
    description: Extract text from DOCX files
    category_type: document-analysis
    priority: medium

  - name: extract-msg
    package: "extract-msg>=0.48.4"
    description: Extract MSG email files
    category_type: document-analysis
    priority: high

  - name: XLMMacroDeobfuscator
    package: XLMMacroDeobfuscator
    description: Excel 4.0 (XLM) macro deobfuscator
    category_type: document-analysis
    priority: high

  - name: xlrd
    package: xlrd
    description: Library for reading Excel files
    category_type: document-analysis
    priority: medium

  - name: XlsxWriter
    package: XlsxWriter
    description: Python module for creating Excel files
    category_type: document-analysis
    priority: low

  - name: pdfalyzer
    package: pdfalyzer
    description: PDF analysis and forensics tool
    category_type: document-analysis
    priority: high

  - name: markitdown
    package: "markitdown[all]"
    description: Convert various formats to Markdown
    category_type: document-analysis
    priority: medium

  # Data Analysis & Forensics
  - name: cart
    package: cart
    description: Classification and Regression Trees
    category_type: data-analysis
    priority: low

  - name: csvkit
    package: csvkit
    description: Suite of utilities for working with CSV files
    category_type: data-analysis
    priority: high

  - name: flatten_json
    package: flatten_json
    description: Flatten JSON objects
    category_type: data-analysis
    priority: medium

  - name: visidata
    package: visidata
    description: Terminal spreadsheet multitool
    category_type: data-analysis
    priority: high

  - name: litecli
    package: litecli
    description: CLI for SQLite with auto-completion
    category_type: data-analysis
    priority: medium

  - name: numpy
    package: numpy
    description: Fundamental package for scientific computing
    category_type: data-analysis
    priority: medium

  # Windows Forensics
  - name: LnkParse3
    package: LnkParse3
    description: Windows LNK file parser
    category_type: windows-forensics
    priority: high

  - name: minidump
    package: minidump
    description: Windows minidump file parser
    category_type: windows-forensics
    priority: high

  # Network Analysis
  - name: scapy
    package: scapy
    description: Interactive packet manipulation program
    category_type: network-analysis
    priority: high

  - name: pwncat
    package: pwncat
    description: Netcat on steroids with firewall/IDS/IPS evasion
    category_type: network-analysis
    priority: medium

  - name: netaddr
    package: netaddr
    description: Network address manipulation library
    category_type: network-analysis
    priority: medium

  # Cryptography & Encoding
  - name: name-that-hash
    package: name-that-hash
    description: Hash type identifier
    category_type: utilities
    priority: high

  - name: chepy
    package: chepy
    description: Python library for data conversion (like CyberChef)
    category_type: utilities
    priority: high

  # Ghidra Integration
  - name: ghidrecomp
    package: ghidrecomp
    description: Ghidra decompiler integration
    category_type: reverse-engineering
    priority: medium

  - name: ghidriff
    package: ghidriff
    description: Ghidra binary diffing tool
    category_type: reverse-engineering
    priority: medium

  - name: pyghidra
    package: pyghidra
    description: Python library for Ghidra automation
    category_type: reverse-engineering
    priority: high

  - name: pcode2code
    package: pcode2code
    description: Ghidra P-code to source code translator
    category_type: reverse-engineering
    priority: medium

  # Binary Analysis
  - name: hachoir
    package: hachoir
    description: Binary file parser and viewer
    category_type: binary-analysis
    priority: high

  # Steganography
  - name: stego-lsb
    package: stego-lsb
    description: LSB steganography tool
    category_type: utilities
    priority: low

  - name: pypng
    package: pypng
    description: Pure Python PNG library
    category_type: utilities
    priority: low

  # Development & Interactive Tools
  - name: jupyterlab
    package: jupyterlab
    description: Web-based interactive development environment
    category_type: development
    priority: high

  - name: ptpython
    package: ptpython
    description: Better Python REPL
    category_type: development
    priority: medium

  - name: jpterm
    package: jpterm
    description: Jupyter in the terminal
    category_type: development
    priority: medium

  - name: grip
    package: grip
    description: GitHub README instant preview
    category_type: development
    priority: low

  # Utilities
  - name: jsbeautifier
    package: jsbeautifier
    description: JavaScript beautifier
    category_type: utilities
    priority: high

  - name: deep_translator
    package: deep_translator
    description: Translation library supporting multiple services
    category_type: utilities
    priority: low

  - name: time-decode
    package: time-decode
    description: Timestamp decoder for various formats
    category_type: utilities
    priority: high

  - name: toolong
    package: toolong
    description: Terminal log file viewer
    category_type: utilities
    priority: medium

  - name: rexi
    package: rexi
    description: Regex interactive tester
    category_type: utilities
    priority: medium

  - name: pip
    package: pip
    description: Python package installer
    category_type: utilities
    priority: high

  # Threat Intelligence
  - name: shodan
    package: shodan
    description: Shodan search engine CLI
    category_type: threat-intel
    priority: medium

  - name: malwarebazaar
    package: malwarebazaar
    description: MalwareBazaar API client
    category_type: threat-intel
    priority: medium

  - name: mkyara
    package: mkyara
    description: YARA rule generator
    category_type: threat-intel
    priority: medium

  - name: magika
    package: magika
    description: AI-powered file type detection
    category_type: utilities
    priority: high

  - name: protodeep
    package: protodeep
    description: Protocol buffer deep inspector
    category_type: utilities
    priority: medium

  - name: pyOneNote
    package: pyOneNote
    description: OneNote file parser
    category_type: document-analysis
    priority: medium

# Python scripts downloaded directly (not packages)
direct_scripts:
  - name: machofile-cli
    url: "https://raw.githubusercontent.com/pstirparo/machofile/main/machofile-cli.py"
    description: Mach-O file format parser CLI
    destination: "${TOOLS}/bin/machofile-cli.py"

  - name: machofile
    url: "https://raw.githubusercontent.com/pstirparo/machofile/main/machofile.py"
    description: Mach-O file format parser library
    destination: "${TOOLS}/bin/machofile.py"

  - name: msidump
    url: "https://raw.githubusercontent.com/mgeeky/msidump/main/msidump.py"
    description: MSI file dump utility
    destination: "${TOOLS}/bin/msidump.py"

  - name: shellconv
    url: "https://raw.githubusercontent.com/hasherezade/shellconv/master/shellconv.py"
    description: Shellcode converter
    destination: "${TOOLS}/bin/shellconv.py"

  - name: smtpsmug
    url: "https://raw.githubusercontent.com/hannob/smtpsmug/main/smtpsmug"
    description: SMTP smuggling tester
    destination: "${TOOLS}/bin/smtpsmug.py"

  - name: SQLiteWalker
    url: "https://raw.githubusercontent.com/stark4n6/SQLiteWalker/main/SQLiteWalker.py"
    description: SQLite database walker
    destination: "${TOOLS}/bin/SQLiteWalker.py"

  - name: CanaryTokenScanner
    url: "https://raw.githubusercontent.com/0xNslabs/CanaryTokenScanner/main/CanaryTokenScanner.py"
    description: Canary token detector
    destination: "${TOOLS}/bin/CanaryTokenScanner.py"

  - name: sigs
    url: "https://raw.githubusercontent.com/clausing/scripts/master/sigs.py"
    description: Signature analysis script
    destination: "${TOOLS}/bin/sigs.py"

  - name: defender-dump
    url: "https://raw.githubusercontent.com/AlexJ4n6/Defender-Quarantine-Dump/refs/heads/main/defender-dump.py"
    description: Windows Defender quarantine dumper
    destination: "${TOOLS}/bin/defender-dump.py"

# Utility scripts from setup
utility_scripts:
  - name: hash-id
    source: "${PWD}/setup/utils/hash-id.py"
    destination: "${TOOLS}/bin/hash-id.py"
    description: Hash identifier utility

  - name: ipexpand
    source: "${PWD}/setup/utils/ipexpand.py"
    destination: "${TOOLS}/bin/ipexpand.py"
    description: IP address expander

  - name: powershell-cleanup
    source: "${PWD}/setup/utils/powershell-cleanup.py"
    destination: "${TOOLS}/bin/powershell-cleanup.py"
    description: PowerShell log cleanup utility

# Git repo scripts copied to bin
repo_scripts:
  - name: bmc-tools
    source: "C:/git/bmc-tools/bmc-tools.py"
    destination: "${TOOLS}/bin/bmc-tools.py"
    description: BMC tools Python script

  - name: dotnetfile_dump
    source: "C:/git/dotnetfile/examples/dotnetfile_dump.py"
    destination: "${TOOLS}/bin/dotnetfile_dump.py"
    description: .NET file dumper

  - name: iShutdown_detect
    source: "C:/git/iShutdown/iShutdown_detect.py"
    destination: "${TOOLS}/bin/iShutdown_detect.py"
    description: iShutdown spyware detector

  - name: iShutdown_parse
    source: "C:/git/iShutdown/iShutdown_parse.py"
    destination: "${TOOLS}/bin/iShutdown_parse.py"
    description: iShutdown log parser

  - name: iShutdown_stats
    source: "C:/git/iShutdown/iShutdown_stats.py"
    destination: "${TOOLS}/bin/iShutdown_stats.py"
    description: iShutdown statistics generator

notes: |
  Python tools require:
  - Python 3.x installed
  - UV package manager (https://github.com/astral-sh/uv)
  - Virtual environment created at C:\venv\default

  Installation is handled by install_python_tools.ps1 which:
  1. Installs Python
  2. Installs UV
  3. Creates virtual environments
  4. Installs packages via `uv tool install`
  5. Downloads direct scripts
  6. Copies utility scripts

  Special handling required for some packages with dependencies.
