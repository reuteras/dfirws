# DFIRWS Document Analysis Tools Definition
# This file defines document analysis, PDF analysis, and Office forensics tools
# Schema version: 1.0

schema_version: "1.0"
category: document-analysis
description: PDF analysis, Office forensics, and document investigation tools

tools:
  # TrID - File identifier
  - name: trid
    description: File identifier utility
    source: http
    url: "https://mark0.net/download/trid_w32.zip"
    file_type: zip
    install_method: extract
    extract_to: "${TOOLS}/trid"
    enabled: true
    priority: high

  # TrIDDefs - TrID definitions
  - name: triddefs
    description: Definition files for TrID
    source: http
    url: "https://mark0.net/download/triddefs.zip"
    file_type: zip
    install_method: extract
    extract_to: "${TOOLS}/trid"
    enabled: true
    priority: high
    notes: Extracts to same directory as TrID

  # PDFStreamDumper - PDF analysis tool
  - name: pdfstreamdumper
    description: PDF analysis and malicious PDF detection
    source: http
    url: "http://sandsprite.com/CodeStuff/PDFStreamDumper_Setup.exe"
    file_type: exe
    install_method: installer
    installer_args: "/SILENT"
    enabled: true
    priority: high

  # qpdf - PDF transformation tool
  - name: qpdf
    description: Command-line program that does structural, content-preserving transformations on PDF files
    source: github
    repo: qpdf/qpdf
    match: "qpdf-.*-msvc64\\.zip$"
    file_type: zip
    install_method: extract
    extract_to: "${TOOLS}/qpdf"
    post_install:
      - type: rename
        pattern: "qpdf-*"
        target: "qpdf"
    enabled: true
    priority: high

  # oledump - OLE file analysis
  - name: oledump
    description: Analyze OLE files (Compound Binary Files)
    source: http
    url: "https://didierstevens.com/files/software/oledump_V0_0_70.zip"
    file_type: zip
    install_method: extract
    extract_to: "${TOOLS}/didier/oledump"
    enabled: true
    priority: high
    notes: Part of Didier Stevens tools

  # pdfid - PDF analysis
  - name: pdfid
    description: Scan PDF files to identify suspicious content
    source: http
    url: "https://didierstevens.com/files/software/pdfid_v0_2_8.zip"
    file_type: zip
    install_method: extract
    extract_to: "${TOOLS}/didier/pdfid"
    enabled: true
    priority: high
    notes: Part of Didier Stevens tools

  # pdf-parser - PDF structure parser
  - name: pdf-parser
    description: Parse and analyze PDF structure
    source: http
    url: "https://didierstevens.com/files/software/pdf-parser_V0_7_8.zip"
    file_type: zip
    install_method: extract
    extract_to: "${TOOLS}/didier/pdf-parser"
    enabled: true
    priority: high
    notes: Part of Didier Stevens tools

  # readpe - PE file reader
  - name: readpe
    description: Read and display PE file information
    source: github
    repo: mentebinaria/readpe"
    match: "readpe.*windows.*\\.zip$"
    file_type: zip
    install_method: extract
    extract_to: "${TOOLS}/readpe"
    enabled: true
    priority: medium

  # elfparser - ELF file parser
  - name: elfparser
    description: ELF binary parser
    source: github
    repo: mentebinaria/elfparser-ng
    match: "elfparser.*\\.zip$"
    file_type: zip
    install_method: extract
    extract_to: "${TOOLS}/elfparser"
    enabled: true
    priority: medium

  # upx - Ultimate Packer for eXecutables
  - name: upx
    description: Ultimate Packer for eXecutables - executable compression
    source: github
    repo: upx/upx
    match: "upx-.*-win64\\.zip$"
    file_type: zip
    install_method: extract
    extract_to: "${TOOLS}/upx"
    post_install:
      - type: rename
        pattern: "upx-*"
        target: "upx"
    enabled: true
    priority: high

  # Malcat - Malware analysis tool
  - name: malcat
    description: Feature-rich hexadecimal editor / disassembler for malware analysis
    source: http
    url: "https://malcat.fr/latest/malcat_win313_lite.zip"
    file_type: zip
    install_method: extract
    extract_to: "${TOOLS}/malcat"
    enabled: true
    priority: high

  # fq - jq for binary formats
  - name: fq
    description: jq for binary formats - tool, language and decoders for working with binary and text formats
    source: github
    repo: wader/fq
    match: "fq_.*_windows_amd64\\.zip$"
    file_type: zip
    install_method: extract
    extract_to: "${TOOLS}/fq"
    enabled: true
    priority: medium

  # gron - Make JSON greppable
  - name: gron
    description: Make JSON greppable
    source: github
    repo: tomnomnom/gron
    match: "gron-windows-amd64.*\\.zip$"
    file_type: zip
    install_method: extract
    extract_to: "${TOOLS}/gron"
    enabled: true
    priority: medium

  # jwt-cli - JWT token tools
  - name: jwt-cli
    description: Encode and decode JWT tokens from the command line
    source: github
    repo: mike-engel/jwt-cli
    match: "jwt-windows\\.exe$"
    file_type: exe
    install_method: copy
    copy_to: "${TOOLS}/bin/jwt.exe"
    enabled: true
    priority: low
