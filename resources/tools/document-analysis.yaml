# DFIRWS Document Analysis Tools Definition
# This file defines document analysis, PDF analysis, and Office forensics tools
# Schema version: 1.0

schema_version: "1.0"
category: document-analysis
description: PDF analysis, Office forensics, and document investigation tools

tools:
  # TrID - File identifier
  - name: trid
    description: File identifier utility
    source: http
    url: "https://mark0.net/download/trid_w32.zip"
    file_type: zip
    install_method: extract
    extract_to: "${TOOLS}/trid"
    enabled: true
    priority: high

  # TrIDDefs - TrID definitions
  - name: triddefs
    description: Definition files for TrID
    source: http
    url: "https://mark0.net/download/triddefs.zip"
    file_type: zip
    install_method: extract
    extract_to: "${TOOLS}/trid"
    enabled: true
    priority: high
    notes: Extracts to same directory as TrID

  # PDFStreamDumper - PDF analysis tool
  - name: pdfstreamdumper
    description: PDF analysis and malicious PDF detection
    source: http
    url: "http://sandsprite.com/CodeStuff/PDFStreamDumper_Setup.exe"
    file_type: exe
    install_method: installer
    installer_args: "/SILENT"
    enabled: true
    priority: high

  # qpdf - PDF transformation tool
  - name: qpdf
    description: Command-line program that does structural, content-preserving transformations on PDF files
    source: github
    repo: qpdf/qpdf
    match: "qpdf-.*-msvc64\\.zip$"
    file_type: zip
    install_method: extract
    extract_to: "${TOOLS}/qpdf"
    post_install:
      - type: rename
        pattern: "${TOOLS}/qpdf/qpdf-*"
        target: "qpdf"
    enabled: true
    priority: high

  # pdf_object_hashing - PDF threat detection
  - name: pdf-object-hashing
    description: PDF threat detection via object hashing - identify related malicious PDFs
    source: github
    repo: EmergingThreats/pdf_object_hashing
    match: "pdf_object_hashing.*\\.zip$"
    file_type: zip
    install_method: extract
    extract_to: "${TOOLS}/pdf_object_hashing"
    enabled: true
    priority: high
    notes: |
      Creates detection rules based on PDF structure "skeleton" or "template".
      Similar to imphash or ja3 hash - extracts object types and hashes them.
      Useful for identifying related documents where content changed but structure remained.
      Helps with attribution when threat actors use PDF builders.
      Requires Python 3.
      Related to GitHub issue #118

  # elfparser - ELF file parser
  - name: elfparser
    description: ELF binary parser
    source: github
    repo: mentebinaria/elfparser-ng
    match: "elfparser.*\\.zip$"
    file_type: zip
    install_method: extract
    extract_to: "${TOOLS}/elfparser"
    enabled: true
    priority: medium

  # Malcat - Malware analysis tool
  - name: malcat
    description: Feature-rich hexadecimal editor / disassembler for malware analysis
    source: http
    url: "https://malcat.fr/latest/malcat_win313_lite.zip"
    file_type: zip
    install_method: extract
    extract_to: "${TOOLS}/malcat"
    enabled: true
    priority: high

  # fq - jq for binary formats
  - name: fq
    description: jq for binary formats - tool, language and decoders for working with binary and text formats
    source: github
    repo: wader/fq
    match: "fq_.*_windows_amd64\\.zip$"
    file_type: zip
    install_method: extract
    extract_to: "${TOOLS}/fq"
    enabled: true
    priority: medium

  # gron - Make JSON greppable
  - name: gron
    description: Make JSON greppable
    source: github
    repo: tomnomnom/gron
    match: "gron-windows-amd64.*\\.zip$"
    file_type: zip
    install_method: extract
    extract_to: "${TOOLS}/gron"
    enabled: true
    priority: medium

  # jwt-cli - JWT token tools
  - name: jwt-cli
    description: Encode and decode JWT tokens from the command line
    source: github
    repo: mike-engel/jwt-cli
    match: "jwt-windows\\.tar\\.gz$"
    file_type: tar.gz
    install_method: extract
    extract_to: "${TOOLS}/jwt-cli"
    enabled: true
    priority: low
