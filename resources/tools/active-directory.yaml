# DFIRWS Active Directory Tools Definition
# This file defines Active Directory analysis and forensics tools
# Schema version: 1.0

schema_version: "1.0"
category: active-directory
description: Active Directory analysis, auditing, and attack path mapping tools

tools:
  # adalanche - Active Directory ACL visualizer and attack path mapper
  - name: adalanche
    description: Active Directory ACL visualizer and attack path analysis
    source: github
    repo: lkarlslund/adalanche
    match: "adalanche-windows-x64"
    file_type: exe
    install_method: copy
    copy_to: "${TOOLS}/bin/adalanche.exe"
    enabled: true
    priority: high

  # DitExplorer - Active Directory database explorer
  - name: ditexplorer
    description: Active Directory database (ntds.dit) explorer
    source: github
    repo: trustedsec/DitExplorer
    match: "DitExplorer.*\\.zip$"
    file_type: zip
    install_method: extract
    extract_to: "${TOOLS}/DitExplorer"
    enabled: true
    priority: high

  # BloodHound - AD attack path analysis
  - name: bloodhound
    description: Active Directory attack path analysis and visualization (Legacy v4.x)
    source: github
    repo: SpecterOps/BloodHound-Legacy
    match: "BloodHound-win32-x64\\.zip$"
    file_type: zip
    install_method: extract
    extract_to: "${TOOLS}/BloodHound"
    post_install:
      - type: rename
        pattern: "BloodHound-win32-*"
        target: "BloodHound"
    enabled: true
    priority: high
    notes: Using Legacy version (v4.x) - BloodHound v8+ is a different architecture

  # SharpHound - BloodHound data collector
  - name: sharphound
    description: BloodHound data collector for Active Directory
    source: github
    repo: SpecterOps/SharpHound
    match: "SharpHound.*\\.zip$"
    file_type: zip
    install_method: extract
    extract_to: "${TOOLS}/SharpHound"
    enabled: true
    priority: high
    notes: Requires .NET Framework

  # PingCastle - AD security assessment
  - name: pingcastle
    description: Active Directory security assessment tool
    source: http
    url: "https://github.com/vletoux/pingcastle/releases/latest/download/PingCastle.zip"
    file_type: zip
    install_method: extract
    extract_to: "${TOOLS}/PingCastle"
    enabled: true
    priority: high
