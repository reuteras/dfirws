# DFIRWS Forensics Tools Definition
# This file defines forensics tools that can be downloaded and installed
# Schema version: 1.0

schema_version: "1.0"
category: forensics
description: Digital forensics and incident response tools

tools:
  # Artemis - Fast forensic collection tool
  - name: artemis
    description: Fast forensic collection tool written in Rust
    source: github
    repo: puffyCid/artemis
    match: "x86_64-pc-windows-msvc\\.zip$"
    file_type: zip
    install_method: extract
    extract_to: "${TOOLS}/artemis"
    post_install:
      - type: rename
        pattern: "artemis-*"
        target: "artemis"
    enabled: true
    priority: high

  # aLEAPP - Android Logs Events And Protobuf Parser
  - name: aleapp
    description: Android Logs Events And Protobuf Parser
    source: github
    repo: abrignoni/aLEAPP
    match: "aleapp-.*Windows\\.zip"
    file_type: zip
    install_method: extract
    extract_to: "${TOOLS}/aleapp"
    post_install:
      - type: copy
        source: "${TOOLS}/aleapp/aleapp.exe"
        target: "${TOOLS}/bin/"
      - type: remove
        target: "${TOOLS}/aleapp"
    enabled: true
    priority: high

  # aLEAPP GUI
  - name: aleappgui
    description: Android Logs Events And Protobuf Parser - GUI version
    source: github
    repo: abrignoni/aLEAPP
    match: "aleappGUI-.*Windows\\.zip"
    file_type: zip
    install_method: extract
    extract_to: "${TOOLS}/aleappGUI"
    post_install:
      - type: copy
        source: "${TOOLS}/aleappGUI/aleappGUI.exe"
        target: "${TOOLS}/bin/"
      - type: remove
        target: "${TOOLS}/aleappGUI"
    enabled: true
    priority: medium

  # iLEAPP - iOS Logs, Events, And Plists Parser
  - name: ileapp
    description: iOS Logs, Events, And Plists Parser
    source: github
    repo: abrignoni/iLEAPP
    match: "ileapp-.*Windows\\.zip"
    file_type: zip
    install_method: extract
    extract_to: "${TOOLS}/ileapp"
    post_install:
      - type: copy
        source: "${TOOLS}/ileapp/ileapp.exe"
        target: "${TOOLS}/bin/"
      - type: remove
        target: "${TOOLS}/ileapp"
    enabled: true
    priority: high

  # iLEAPP GUI
  - name: ileappgui
    description: iOS Logs, Events, And Plists Parser - GUI version
    source: github
    repo: abrignoni/iLEAPP
    match: "ileappGUI-.*Windows\\.zip"
    file_type: zip
    install_method: extract
    extract_to: "${TOOLS}/ileappGUI"
    post_install:
      - type: copy
        source: "${TOOLS}/ileappGUI/ileappGUI.exe"
        target: "${TOOLS}/bin/"
      - type: remove
        target: "${TOOLS}/ileappGUI"
    enabled: true
    priority: medium

  # Autopsy - Digital forensics platform
  - name: autopsy
    description: Digital forensics platform and graphical interface to The Sleuth Kit
    source: github
    repo: sleuthkit/autopsy
    match: "autopsy-.*-64bit\\.msi"
    file_type: msi
    install_method: installer
    installer_args: "/qn /norestart"
    enabled: true
    priority: high
    notes: Requires Java Runtime Environment

  # QELP - Quick ESXi Log Parser
  - name: qelp
    description: Quick ESXi Log Parser for incident response and forensics
    source: github
    repo: strozfriedberg/qelp
    match: "qelp.*\\.zip$"
    file_type: zip
    install_method: extract
    extract_to: "${TOOLS}/qelp"
    enabled: true
    priority: high
    notes: |
      Parses ESXi logs and produces CSV reports in timeline format.
      Tracks SSH access, user logons, password changes, file transfers, etc.
      Supports partially encrypted ESXi logs.
      Requires Python 3.
      Related to GitHub issue #120

  # RDP Cache Stitcher
  - name: rdpcachestitcher
    description: Reconstruct images from RDP cache files
    source: github
    repo: BSI-Bund/RdpCacheStitcher
    match: "win64"
    file_type: zip
    install_method: extract
    extract_to: "${TOOLS}"
    post_install:
      - type: rename
        pattern: "RdpCacheStitcher_*"
        target: "RdpCacheStitcher"
    enabled: true
    priority: medium
