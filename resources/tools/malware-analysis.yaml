# DFIRWS Malware Analysis Tools Definition
# This file defines malware analysis and reverse engineering tools
# Schema version: 1.0

schema_version: "1.0"
category: malware-analysis
description: Malware analysis and reverse engineering tools

tools:
  # BeaconHunter - Cobalt Strike beacon detection
  - name: beaconhunter
    description: Cobalt Strike beacon configuration parser and detection tool
    source: github
    repo: 3lp4tr0n/BeaconHunter
    match: "BeaconHunter\\.zip"
    file_type: zip
    install_method: extract
    extract_to: "${TOOLS}/BeaconHunter"
    enabled: true
    priority: high

  # CobaltStrikeScan - Detect Cobalt Strike beacons
  - name: cobaltstrikescan
    description: Scan files or process memory for Cobalt Strike beacons
    source: github
    repo: Apr4h/CobaltStrikeScan
    match: "CobaltStrikeScan"
    file_type: exe
    install_method: copy
    copy_to: "${TOOLS}/bin/CobaltStrikeScan.exe"
    enabled: true
    priority: high

  # FLOSS - FireEye Labs Obfuscated String Solver
  - name: floss
    description: Automatically extract obfuscated strings from malware
    source: github
    repo: mandiant/flare-floss
    match: "windows\\.zip$"
    file_type: zip
    install_method: extract
    extract_to: "${TOOLS}/floss"
    enabled: true
    priority: high

  # MinusOne - PowerShell deobfuscation engine
  - name: minusone
    description: Deobfuscation engine for PowerShell and other scripting languages
    source: github
    repo: airbus-cert/minusone
    match: "minusone.*windows.*\\.zip$"
    file_type: zip
    install_method: extract
    extract_to: "${TOOLS}/minusone"
    enabled: true
    priority: high
    notes: |
      Tree-sitter based deobfuscation engine written in Rust.
      Applies rule-based system to infer node values and simplify expressions.
      Supports Python bindings.
      Part of Airbus CERT forensics toolkit.
      Related to GitHub issue #116

  # CAPA - Detect capabilities in executable files
  - name: capa
    description: Detect capabilities in executable files
    source: github
    repo: mandiant/capa
    match: "windows\\.zip$"
    file_type: zip
    install_method: extract
    extract_to: "${TOOLS}/capa"
    enabled: true
    priority: high

  # CAPA Rules - Rules database for CAPA
  - name: capa-rules
    description: Collection of rules for CAPA to detect malware capabilities
    source: github
    repo: mandiant/capa-rules
    match: "Source.*\\.zip$"
    file_type: zip
    install_method: extract
    extract_to: "${TOOLS}/capa/rules"
    enabled: true
    priority: high
    notes: Rules database for CAPA capability detection

  # PE-bear - Portable Executable analysis tool
  - name: pe-bear
    description: Portable Executable reversing tool with a GUI
    source: github
    repo: hasherezade/pe-bear
    match: "PE-bear.*_x64_win_vs22\\.zip"
    file_type: zip
    install_method: extract
    extract_to: "${TOOLS}/pe-bear"
    enabled: true
    priority: high

  # HollowsHunter - Detect and dump malicious implants
  - name: hollowshunter
    description: Scans processes for signs of code injection and dumps suspicious implants
    source: github
    repo: hasherezade/hollows_hunter
    match: "hollows_hunter.*64\\.zip"
    file_type: zip
    install_method: extract
    extract_to: "${TOOLS}/hollowshunter"
    enabled: true
    priority: high

  # PE-sieve - Detect and dump suspicious modules
  - name: pe-sieve
    description: Detect and dump suspicious modules from process memory
    source: github
    repo: hasherezade/pe-sieve
    match: "pe-sieve64\\.zip"
    file_type: zip
    install_method: extract
    extract_to: "${TOOLS}/pe-sieve"
    enabled: true
    priority: high

  # YARA - Pattern matching swiss army knife
  - name: yara
    description: Pattern matching swiss army knife for malware researchers
    source: github
    repo: VirusTotal/yara
    match: "win64\\.zip$"
    file_type: zip
    install_method: extract
    extract_to: "${TOOLS}/yara"
    post_install:
      - type: add_to_path
        path: "${TOOLS}/yara"
    enabled: true
    priority: high

  # YARA-X - Next generation YARA
  - name: yara-x
    description: Next generation YARA with improved performance and features
    source: github
    repo: VirusTotal/yara-x
    match: "x86_64-pc-windows-msvc\\.zip$"
    file_type: zip
    install_method: extract
    extract_to: "${TOOLS}/yara-x"
    post_install:
      - type: add_to_path
        path: "${TOOLS}/yara-x"
    enabled: true
    priority: high
